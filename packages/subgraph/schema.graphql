type Delegate @entity {
  id: ID! # bytes32 identifier, probably an address but with room for chain-specific addresses if wanted.
  delegations: [Delegation!]! @derivedFrom(field: "delegate")
  optouts: [Optout!]! @derivedFrom(field: "delegate")
}

type Account @entity {
  id: ID! # address to identify account
  delegationSets: [DelegationSet!]! @derivedFrom(field: "account")
  delegations: [Delegation!]! @derivedFrom(field: "account")
}

type Context @entity {
  id: ID! # string to identify context
  delegationSets: [DelegationSet!]! @derivedFrom(field: "context")
  delegations: [Delegation!]! @derivedFrom(field: "context")
  optouts: [Optout!]! @derivedFrom(field: "context")
}

type DelegationSet @entity {
  id: ID! # `${context.id}-${account.id}`
  account: Account!
  context: Context!
  denominator: BigInt!
  expiration: BigInt!
  delegationUpdated: BigInt!
  expirationUpdated: BigInt!
  delegations: [Delegation!]! @derivedFrom(field: "delegationSet")
}

type Optout @entity {
  id: ID! # `${context.id}-${delegate.id}`
  delegate: Delegate!
  context: Context!
}

type Delegation @entity {
  id: ID! # `${context.id}-${account.id}-${delegate.id}`
  context: Context!
  account: Account!
  delegate: Delegate!
  delegationSet: DelegationSet!
  numerator: BigInt!
}
